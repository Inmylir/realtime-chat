name = "cf-workers-chat"
type = "javascript"
compatibility_date = "2025-12-01"

# 迁移配置：使用 SQLite 存储 Durable Object
[[migrations]]
tag = "v1"
new_sqlite_classes = ["ChatRoom"]  # 这里使用 SQLite 存储，适用于免费计划

[durable_objects]
bindings = [
  { name = "ROOM", class_name = "ChatRoom" }
]

# 静态资源上传和托管配置
[assets]
directory = "./public"
binding = "ASSETS"

# D1 数据库配置：用于存储永久消息
[[d1_databases]]
binding = "DB"
database_name = "chat-db"
database_id = "a7e33370-465a-4086-8492-b4de2eef3c41"  # 请替换为你的数据库 ID

# R2 存储配置：用于存储图片和视频
[[r2_buckets]]
binding = "MEDIA"
bucket_name = "chat-media"

[vars]
# 是否允许注册：建议在生产环境中设置为 "false"，仅管理员可预置账号
ALLOW_REGISTER = "true"
